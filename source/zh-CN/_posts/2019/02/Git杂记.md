---
title: Gitæ‚è®°
date: 2019-02-27 23:12:27
categories: [ç‰ˆæœ¬æ§åˆ¶]
---

ç¨å¾®è®°å½•ä¸€ä¸‹å¸¸ç”¨gitå‘½ä»¤

<!-- More -->

<!-- TODO -->

## ç™»é™†git

```shell
git config --global user.name "Your Name"
git config --global user.email "email@example.com"
```

âš  æ¯å°è®¾å¤‡è¦ä½¿ç”¨ä¸åŒçš„`user.name`, è¿™æ ·æ‰èƒ½åŒºåˆ†å®ƒä»¬. ä¸ºäº†æ–¹ä¾¿è®°å¿†å¯ä»¥ç»Ÿä¸€ä½¿ç”¨**æ˜µç§°-æœºå™¨å‹å·**
çš„å‘½åæ–¹å¼.

å€¼å¾—ä¸€æçš„æ˜¯gitçš„é…ç½®æ–‡ä»¶åˆ†ä¸‰çº§: ç³»ç»Ÿçº§(æ‰€æœ‰ç”¨æˆ·çš„), å…¨å±€çº§(å½“å‰ç”¨æˆ·çš„), ä»“åº“çº§.
åœ¨é…ç½®æ—¶åˆ†åˆ«ä½¿ç”¨`--system`, `--global`, `--local`å‚æ•°æ¥è®¿é—®.å¦‚æœæƒ³ç›´æ¥è¿›å…¥é…ç½®æ–‡ä»¶è€Œ
ä¸æ˜¯ä¸€ä¸ªå‚æ•°ä¸€ä¸ªå‚æ•°åœ°è®¾ç½®å¯ä»¥ä½¿ç”¨:

```shell
git config -e
```

è¦æ³¨æ„é»˜è®¤æƒ…å†µä¸‹`git config -e`è®¿é—®**ä»“åº“çº§é…ç½®æ–‡ä»¶**.

## æœ‰å…³SSH

ç”¨sshæ–¹å¼ç™»å½•gitçš„è¯åªæ˜¯ç”Ÿæˆç§˜é’¥å’Œåœ¨è¿œç¨‹ç«¯æ·»åŠ ç§˜é’¥éº»çƒ¦ä¸€æ¬¡, åé¢å°±å¯ä»¥å…å¯†ç , è€Œ
ç”¨httpç™»å½•çš„è¯æ¯æ¬¡pushéƒ½éœ€è¦è¾“å…¥å¯†ç , ç•¥å¾®éº»çƒ¦.

### è·å–SSH Key

é¦–å…ˆæŸ¥çœ‹æœ‰æ²¡æœ‰**~/.ssh**è¿™ä¸ªæ–‡ä»¶å¤¹ä»¥åŠæ–‡ä»¶å¤¹ä¸‹æœ‰æ²¡æœ‰`id_rsa`å’Œ`id_rsa.pub`ä¸¤ä¸ªæ–‡ä»¶.
å¦‚æœæœ‰, é‚£å°±ä¸ç”¨ç”Ÿæˆäº†.

è¿™ä¸¤ä¸ªå°±æ˜¯SSH Keyçš„ç§˜é’¥å¯¹ï¼Œ`id_rsa`æ˜¯ç§é’¥ï¼Œä¸èƒ½æ³„éœ²å‡ºå»ï¼Œ`id_rsa.pub`æ˜¯å…¬é’¥
å¯ä»¥æ”¾å¿ƒåœ°å‘Šè¯‰ä»»ä½•äºº. æ¯”å¦‚åŠ å…¥GitHubçš„SSH Key.

### ç”Ÿæˆkey

```bash
ssh-keygen -t rsa -C "youremail@example.com"
```

å¦‚æœæ²¡æœ‰ç‰¹åˆ«éœ€æ±‚(æ¯”å¦‚ç”šè‡³æƒ³è®¾ç½®å¯†ç ), ç›´æ¥è¿æ•²ä¸‰æ¬¡å›è½¦.

ğŸ’¡ å…¶å®åœ¨è¾“å…¥å‘½ä»¤åç¬¬ä¸€ä¸ªé€‰é¡¹æ˜¯æŒ‡å®šç”Ÿæˆçš„ç§˜é’¥æ–‡ä»¶å, å¯ä»¥æŒ‡å®šä¸º`id_rsa_github`,
`id_rsa_gitee`è¿™æ ·, åŠ ä¸Šè¿œç¨‹ç«¯çš„åå­—, è¿™æ ·æœ‰å¤šä¸ªè¿œç¨‹ç«¯æ—¶ä¹Ÿä¸ä¼šæ··ä¹±.

æœ‰è¶£çš„æ˜¯æˆ‘å‘ç°åŒä¸€å°æœºå™¨, å¦‚æœä»æ˜¯æ•²ä¸‰æ¬¡å›è½¦ç”Ÿæˆçš„Keyæ¯æ¬¡æ˜¯ä¸€æ ·çš„.

### åŒæ—¶ä¸Šä¼ åˆ°å¤šä¸ªè¿œç¨‹ç«¯

æ–°å»º`~/.ssh/config`, å¦‚æœè¿œç¨‹ç«¯æ˜¯githubå’Œgitee, githubå’Œgiteeçš„ssh keyæ˜¯åƒä¸Šé¢è¯´
çš„è¿™æ ·å‘½åçš„, é‚£ä¹ˆå†…å®¹å¦‚ä¸‹:

```shell
# github
Host github.com
HostName github.com
PreferredAuthentications publickey
IdentityFile ~/.ssh/id_rsa_github

# gitee
Host gitee.com
HostName gitee.com
PreferredAuthentications publickey
IdentityFile ~/.ssh/id_rsa_gitee
```

## ä¸‹è½½ä¸€ä¸ªrepository

:warning: æœ‰httpå’Œsshä¸¤ç§é“¾æ¥, æ¨èä½¿ç”¨ssh, æœ‰æ—¶httpå½¢å¼å¹¶ä¸è¢«æ”¯æŒ, æ¯”å¦‚hexoçš„git
ä¸Šä¼ åŠŸèƒ½.

```shell
git clone [url]
```

### ä¸‹è½½ç‰¹å®šåˆ†æ”¯

```shell
git clone -b [branch] [url]
```

## æŸ¥çœ‹çŠ¶æ€

```shell
git status
```

## æš‚å­˜æ‰€æœ‰æ›´æ”¹

```shell
git add .
```

## æäº¤

```shell
git commit
```

## ä¸Šä¼ 

```shell
git push
```

:warning: ä¸ªäººä»“åº“çš„è¯æäº¤ä¹‹åä¸€å®šä¸è¦å¿˜è®°ä¸Šä¼ ! æˆ‘åœ¨æ ¼å¼åŒ–ç”µè„‘å‰å¿˜è®°å°†æœ¬åœ°commit
ä¸Šä¼ , å¤±å»äº†å¥½å‡ ç¯‡åšæ–‡å•Š:cry: (ä½†åº”è¯¥ä¸€èˆ¬æ²¡æœ‰æˆ‘è¿™ä¹ˆè ¢çš„)

## gitä»“åº“ç˜¦èº«

æˆ‘ä¹Ÿç»ˆäºé‡åˆ°äº†gitä»“åº“è¢«æå¤ªå¤§éœ€è¦ç˜¦èº«çš„æƒ…å†µäº†.

> [BFG](http://rtyley.github.io/bfg-repo-cleaner/) æ˜¯ä¸ºå°†åƒå¤§æ–‡ä»¶æˆ–è€…å¯†ç è¿™äº›ä¸æƒ³è¦çš„æ•°æ®ä» Git ä»“åº“ä¸­åˆ é™¤è€Œä¸“é—¨è®¾è®¡çš„ï¼Œæ‰€ä»¥å®ƒæœ‰ä¸€ä¸€ä¸ªç®€å•çš„æ ‡å¿—ç”¨æ¥åˆ é™¤é‚£äº›å¤§çš„å†å²æ–‡ä»¶ï¼ˆä¸åœ¨å½“å‰çš„æäº¤é‡Œé¢ï¼‰ï¼š`--strip-blobs-bigger-than`

âš ï¸ è¦ç”¨bfgä½ éœ€è¦æœ‰java

1. é¦–å…ˆä»¥`--mirror`é€‰é¡¹ä»è¿œç¨‹ç«¯ä¸‹è½½ä»“åº“. æŒ‰ç…§bfgçš„è¯´æ³•è¿™æ ·ä¸‹åˆ°çš„æ˜¯ä¸€ä¸ª"bare repo".

> This is a bare repo, which means your normal files won't be visible, but it is a full copy of the Git database of your repository

(æˆ‘è¯•äº†ä¸€ä¸‹æ™®é€šcloneçš„ä»“åº“æ“ä½œå®Œæœ€åæ¨é€ä¸ä¸Šå»...)

```shell
git clone --mirror git://example.com/some-big-repo.git
```

2. ç„¶åè¿›å…¥ä»“åº“, ç„¶åæŒ‰ç…§æ–‡ä»¶å¤§å°æˆ–è€…æ–‡ä»¶åæ¸…ç†æ–‡ä»¶.

â—ï¸ åœ¨è¿™ä¸€æ­¥æ–‡ä»¶å¹¶æ²¡æœ‰åœ¨ç‰©ç†ä¸Šè¢«åˆ é™¤, åœ¨è¿™ä¸€æ­¥bfgä¼šæ¸…ç†æ‰€æœ‰commit, branch, tag, å»æ‰è¯¥æ–‡ä»¶çš„è®°å½•.

- æ¸…ç†å¤§äºæŒ‡å®šå€¼çš„æ–‡ä»¶

```shell
java -jar bfg.jar --strip-blobs-bigger-than 100M
```

> å¤§å°è¶…è¿‡ 100MB çš„ä»»ä½•æ–‡ä»¶ï¼ˆä¸åŒ…å«åœ¨ä½ *æœ€è¿‘çš„*æäº¤ä¸­çš„æ–‡ä»¶â€”â€”å› ä¸º BFG [é»˜è®¤ä¼šä¿æŠ¤ä½ çš„æœ€æ–°æäº¤çš„å†…å®¹](http://rtyley.github.io/bfg-repo-cleaner/#protected-commits)ï¼‰å°†ä¼šä»ä½ çš„Gitä»“åº“çš„å†å²è®°å½•ä¸­åˆ é™¤.

- æ¸…ç†æŒ‡å®šæ–‡ä»¶åæ–‡ä»¶:

```shell
java -jar bfg.jar --delete-files *.mp4
```

3. å°†ä¸Šé¢æ¸…ç†å‡ºæ¥çš„æ–‡ä»¶åˆ é™¤

```shell
git reflog expire --expire=now --all && git gc --prune=now --aggressive
```

4. å½“ä½ è§‰å¾—åˆ å¾—å·®ä¸å¤šå°±å¯ä»¥æ¨é€äº†. â—ï¸ è¿™æ ·ä¼šæ”¹å˜è¿œç¨‹ç«¯æ‰€æœ‰ref.

```shell
git push
```